---
title: "African Languages"
author: "Bonsoul"
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidytuesdayR)
library(dplyr)
library(flextable)

```

```{r}
tuesdata <- tidytuesdayR::tt_load(2026, week = 2)

africa <- tuesdata$africa
```

```{r}
africa %>%
  summarise(
    min = min(native_speakers, na.rm = TRUE),
    max = max(native_speakers, na.rm = TRUE),
    mean = mean(native_speakers, na.rm = TRUE),
    median = median(native_speakers, na.rm = TRUE),
    sd = sd(native_speakers, na.rm = TRUE)
  ) %>%
  flextable()


```

```{r}
africa %>%
  mutate(log_speakers = log10(native_speakers)) %>%
  summarise(
    mean_log = mean(log_speakers),
    median_log = median(log_speakers)
  ) %>%
  flextable()


```


```{r}
boxplot(log10(africa$native_speakers),
        main = "Log Distribution of Native Speakers",
        ylab = "Log10(Native Speakers)")


```

```{r}
africa %>%
  count(family, sort = TRUE) %>%
  flextable()
```

```{r}
africa %>%
  count(country, sort = TRUE) %>%
  flextable()

```

```{r}
africa %>%
  group_by(family) %>%
  summarise(
    total_speakers = sum(native_speakers, na.rm = TRUE),
    mean_speakers = mean(native_speakers, na.rm = TRUE),
    n_languages = n()
  ) %>%
  arrange(desc(total_speakers)) %>%
  flextable()

```


```{r}
hist(log10(africa$native_speakers),
     main = "Log Distribution of Native Speakers",
     xlab = "Log10(Native Speakers)")

```

```{r}
africa %>%
  count(country, family) %>%
  group_by(country) %>%
  mutate(prop = n / sum(n)) %>%
  flextable()

```

```{r,Top 10 African Countries by Number of Spoken Languages}
library(dplyr)
library(ggplot2)

africa %>%
  count(country, sort = TRUE) %>%
  slice_head(n = 10) %>%
  ggplot(aes(x = n, y = reorder(country, n))) +
  geom_col(fill = "steelblue") +
  labs(
    title = "Top 10 African Countries by Number of Spoken Languages",
    x = "Number of Languages",
    y = "Country"
  ) +
  theme_minimal()

```

```{r,Total Native Speakers by Language Family (Log Scale)}
africa %>%
  group_by(family) %>%
  summarise(total_speakers = sum(native_speakers, na.rm = TRUE)) %>%
  arrange(desc(total_speakers)) %>%
  ggplot(aes(x = reorder(family, total_speakers), y = total_speakers)) +
  geom_col(fill = "darkorange") +
  scale_y_log10() +
  coord_flip() +
  labs(
    title = "Total Native Speakers by Language Family (Log Scale)",
    x = "Language Family",
    y = "Total Native Speakers (log scale)"
  ) +
  theme_minimal()

```


```{r}
africa %>%
  group_by(language) %>%
  summarise(n_countries = n_distinct(country)) %>%
  filter(n_countries > 1) %>%
  arrange(desc(n_countries)) %>%
  slice_head(n = 15) %>%
  ggplot(aes(x = n_countries, y = reorder(language, n_countries))) +
  geom_col(fill = "purple") +
  labs(
    title = "Languages Spoken Across Multiple African Countries",
    x = "Number of Countries",
    y = "Language"
  ) +
  theme_minimal()

```

```{r}
Sys.setenv(SHAPE_RESTORE_SHX = "YES")

```


```{r}
library(sf)
africa_shape <- st_read("Africa Shape/afr_g2014_2013_0.shp")

```

```{r}
library(dplyr)

lang_by_country <- africa %>%
  count(country, name = "n_languages") %>%
  # Fix names to match shapefile
  mutate(country = case_when(
    country == "Ivory Coast" ~ "C\xf4te d'Ivoire",
    country == "DR Congo" ~ "Democratic Republic of the Congo",
    country == "Tanzania" ~ "United Republic of Tanzania",
    country == "Cape Verde" ~ "Cape Verde",
    TRUE ~ country
  ))


```

```{r}
africa_map_data <- africa_shape %>%
  left_join(lang_by_country, by = c("ADM0_NAME" = "country"))

```

```{r}
library(ggplot2)

ggplot(africa_map_data) +
  geom_sf(aes(fill = n_languages), color = "white", linewidth = 0.2) +
  scale_fill_viridis_c(
    option = "plasma",
    na.value = "grey90"
  ) +
  labs(
    title = "Number of Spoken Languages by Country in Africa",
    subtitle = "Based on documented languages in the dataset",
    fill = "Languages"
  ) +
  theme_minimal()

```

```{r}
ggplot(africa_map_data) +
  geom_sf(aes(fill = n_languages), color = "white", linewidth = 0.2) +
  scale_fill_gradient(
    low = "lightgreen",
    high = "darkgreen",
    na.value = "grey90"
  ) +
  labs(
    title = "Number of Spoken Languages by Country in Africa",
    subtitle = "Based on documented languages in the dataset",
    fill = "Languages"
  ) +
  theme_minimal()


```


```{r}
library(dplyr)
library(sf)

lang_map_data <- africa %>%
  left_join(
    africa_centroids %>% select(ADM0_NAME, geometry),  # keep geometry
    by = c("country" = "ADM0_NAME")
  ) %>%
  st_as_sf()

```

```{r}
library(ggplot2)

ggplot() +
  geom_sf(data = africa_map_data, fill = "lightgreen", color = "white", linewidth = 0.2) +
  geom_sf(data = lang_map_data, aes(color = family), size = 2, alpha = 0.7) +
  labs(
    title = "Languages Across African Countries",
    subtitle = "Each point represents a language in its country",
    color = "Language Family"
  ) +
  theme_minimal()

```

