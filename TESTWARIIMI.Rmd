---
title: "TEST_MODELING"
author: "Bonsoul"
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
```

```{r}
fg <- read_csv("D:/Downloads/depressed_PHQ_dataset_123rows.csv")
```

```{r}
glimpse(fg)
```

```{r}
library(dplyr)
library(tidyr)
library(stringr)

# Optional: nice item labels
item_labels <- c(
  PHQ1_feeling_sad       = "1. FEELING SAD, DOWN, HOPELESS, OR IRRITABLE",
  PHQ2_crying_more       = "2. CRYING MORE THAN USUAL",
  PHQ3_loss_interest     = "3. LOSS OF INTEREST OR PLEASURE",
  PHQ4_less_time_friends = "4. SPENDING LESS TIME WITH FRIENDS",
  PHQ5_sleep             = "5. TROUBLE FALLING OR STAYING ASLEEP / SLEEPING TOO MUCH",
  PHQ6_appetite          = "6. POOR APPETITE, WEIGHT LOSS, OR OVEREATING",
  PHQ7_tired             = "7. FEELING TIRED OR HAVING LITTLE ENERGY",
  PHQ8_feeling_bad       = "8. FEELING BAD ABOUT YOURSELF / FEELING LIKE A FAILURE",
  PHQ9_concentration     = "9. TROUBLE CONCENTRATING",
  PHQ10_self_harm        = "10. THOUGHTS OF SELF-HARM OR BEING BETTER OFF DEAD"
)

phq_summary <- fg %>%
  pivot_longer(
    everything(),
    names_to = "ITEM",
    values_to = "RESPONSE"
  ) %>%
  mutate(
    ITEM = item_labels[ITEM]  # replace column names with readable names
  ) %>%
  group_by(ITEM, RESPONSE) %>%
  summarise(
    COUNT = n(),
    PERCENT = round(100 * COUNT / nrow(fg), 1),
    .groups = "drop"
  ) %>%
  arrange(ITEM, desc(COUNT))

phq_summary

```

```{r}
library(kableExtra)
library(knitr)
```



```{r}
phq_summary <- fg %>%
  pivot_longer(
    everything(),
    names_to = "ITEM",
    values_to = "RESPONSE"
  ) %>%
  mutate(
    ITEM = item_labels[ITEM]   # Replace variable names with readable item labels
  ) %>%
  group_by(ITEM, RESPONSE) %>%
  summarise(
    COUNT = n(),
    PERCENT = round(100 * COUNT / nrow(fg), 1),
    .groups = "drop"
  ) %>%
  arrange(ITEM, desc(COUNT))

# Print using kable
kable(
  phq_summary,
  caption = "PHQ-A Item Response Summary",
  align = "l l r r",
  digits = 1
)
```

```{r}
library(dplyr)
library(tidyr)
library(knitr)
library(kableExtra)

# Optional item labels
item_labels <- c(
  PHQ1_feeling_sad       = "1. FEELING SAD, DOWN, HOPELESS, OR IRRITABLE",
  PHQ2_crying_more       = "2. CRYING MORE THAN USUAL",
  PHQ3_loss_interest     = "3. LOSS OF INTEREST OR PLEASURE",
  PHQ4_less_time_friends = "4. SPENDING LESS TIME WITH FRIENDS",
  PHQ5_sleep             = "5. TROUBLE FALLING OR STAYING ASLEEP / SLEEPING TOO MUCH",
  PHQ6_appetite          = "6. POOR APPETITE, WEIGHT LOSS, OR OVEREATING",
  PHQ7_tired             = "7. FEELING TIRED OR HAVING LITTLE ENERGY",
  PHQ8_feeling_bad       = "8. FEELING BAD ABOUT YOURSELF / FEELING LIKE A FAILURE",
  PHQ9_concentration     = "9. TROUBLE CONCENTRATING",
  PHQ10_self_harm        = "10. THOUGHTS OF SELF-HARM OR BEING BETTER OFF DEAD"
)

# Create summary table
phq_summary <- fg %>%
  pivot_longer(
    everything(),
    names_to = "ITEM",
    values_to = "RESPONSE"
  ) %>%
  mutate(
    ITEM = item_labels[ITEM]
  ) %>%
  group_by(ITEM, RESPONSE) %>%
  summarise(
    COUNT = n(),
    PERCENT = round(100 * COUNT / nrow(fg), 1),
    .groups = "drop"
  ) %>%
  arrange(ITEM, desc(COUNT))

# Pretty kableExtra table
phq_summary %>%
  kable(
    format = "html",   # use "latex" if knitting to PDF
    caption = "PHQ-A Item Response Summary",
    align = c("l", "l", "r", "r"),
    digits = 1
  ) %>%
  kable_styling(
    bootstrap_options = c("striped", "hover", "condensed", "responsive"),
    full_width = FALSE,
    position = "left"
  ) %>%
  row_spec(0, bold = TRUE, background = "#f0f0f0")   # style header

```




