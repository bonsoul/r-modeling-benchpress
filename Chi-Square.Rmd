---
title: "CHI-SQUARE"
author: "Bonsoul"
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
df101 <- df11 %>% mutate(id = row_number())
data_bin <- data_binary %>% mutate(id = row_number())

```

```{r}
merged_data <- df101 %>%
  select(id, PHQ_severity) %>%
  left_join(data_bin, by = "id")

```

```{r}
merged_data <- merged_data %>%
  mutate(
    PHQ_severity = factor(PHQ_severity),
    across(-c(id, PHQ_severity), factor)
  )

```

```{r}
adherence_vars <- c(
  "Miss_Medicines",
  "Refuse_Medicines",
  "Not_Take_In_Front_Of_Others",
  "Do_Not_Know_Why_Taking",
  "Problems_Taking_On_Time",
  "Overall_Adherence"
)

chi_results <- lapply(adherence_vars, function(var) {
  tab <- table(merged_data$PHQ_severity, merged_data[[var]])
  test <- chisq.test(tab)

  data.frame(
    Variable = var,
    Chi_square = test$statistic,
    df = test$parameter,
    p_value = test$p.value
  )
})

chi_results <- do.call(rbind, chi_results)
chi_results

```

